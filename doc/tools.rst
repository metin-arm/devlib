
Tools
=====

Building buildroot
------------------

``generate-kernel-initrd.sh`` helper script downloads and builds ``buildroot``
per config files located under ``tools/buildroot/configs`` for the specified
architecture.

The script roughly checks out ``2023.11.1`` tag of ``buildroot``, copies config
files for buildroot (e.g., ``configs/aarch64/arm-power_aarch64_defconfig``) and
kernel (e.g., ``configs/aarch64/linux.config``) to necessary places under
buildroot directory, and runs ``make arm-power_aarch64_defconfig && make``
commands.

As its name suggests, ``generate-kernel-initrd.sh`` builds kernel image with an
initial RAM disk per default config files.

There is also ``post-build.sh`` script in order to make following tunings on
root filesystem generated by ``buildroot``:
- allow root login on SSH.
- increase number of concurrent SSH connections/channels to let devlib
  consumers hammering the target system.

In order to keep rootfs minimal, only OpenSSH and util-linux packages
are enabled in the default configuration files.

DHCP client and SSH server services are enabled on target system startup.

SCHED_MC, SCHED_SMT and UCLAMP_TASK scheduler features are enabled for aarch64
kernel.

If you need to make changes on ``buildroot``, rootfs or kernel of target
system, you may want to run commands similar to these:

.. code:: shell

   $ cd tools/buildroot/buildroot-v2023.11.1
   $ make menuconfig    # or 'make linux-menuconfig' if you want to configure kernel
   $ make

See https://buildroot.org/downloads/manual/manual.html for details.
